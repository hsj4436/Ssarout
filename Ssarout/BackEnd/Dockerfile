FROM openjdk:8-jdk
ENV JAVA_OPTS "-XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap -XX:MaxRAMFraction=1 -XshowSettings:vm"
EXPOSE 8080
ARG DB_PASSWORD
ARG DB_URL
ARG GOOGLE_CLIENT_ID
ARG GOOGLE_CLIENT_SECRET
ARG JWT_SECRET
ARG KAKAO_CLIENT_ID
ARG KAKAO_CLIENT_SECRET
ARG TOKEN_SECRET
ARG JAR_FILE=build/libs/ssaout-0.0.1-SNAPSHOT.jar

ENV DB_PASSWORD=$DB_PASSWORD
ENV DB_URL=$DB_URL
ENV GOOGLE_CLIENT_ID=$GOOGLE_CLIENT_ID
ENV GOOGLE_CLIENT_SECRET=$GOOGLE_CLIENT_SECRET
ENV JWT_SECRET=$JWT_SECRET
ENV KAKAO_CLIENT_ID=$KAKAO_CLIENT_ID
ENV KAKAO_CLIENT_SECRET=$KAKAO_CLIENT_SECRET
ENV TOKEN_SECRET=$TOKEN_SECRET

COPY ${JAR_FILE} ssaout.jar
ENTRYPOINT ["java","-jar","Djwt.secret=JWT_SECRET","/ssaout.jar","&"]